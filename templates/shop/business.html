{% load static %}
{% include 'partials/css.html' %}
<nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme"
    id="layout-navbar">
    <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
        <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
            <i class="bx bx-menu bx-sm"></i>
        </a>
    </div>

    <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse pac-input">
        <!-- Search -->
        <div class="navbar-nav align-items-center">
            <div class="nav-item d-flex align-items-center">
                <i class="bx bx-search fs-4 lh-0"></i>
                <input type="text" class="form-control border-0 shadow-none" placeholder="Search..."
                    aria-label="Search..." />
            </div>
        </div>
        <!-- /Search -->
    </div>
</nav>

<div id="googleMap" style="width:100%;height:800px;"></div>
<br>
<!--    map types-->
<!--    mapTypeId: google.maps.MapTypeId.SATELLITE-->
<!--    mapTypeId: google.maps.MapTypeId.HYBRID-->
<!--    mapTypeId: google.maps.MapTypeId.TERRAIN-->
<script>

    var p;
    function getLocation() {
        if (navigator.geolocation)
            navigator.geolocation.getCurrentPosition(callBack)
        else
            alert("Sorry! your browser is not supporting")
    }
    function callBack(position) {
        p = position
        alert("" + p.coords.latitude + " " + p.coords.longitude)
    }

    function myMap() {
        getLocation()
        mapOptions = {
            //center: new google.maps.LatLng(p.coords.latitude, p.coords.longitude),
            center: new google.maps.LatLng(-1.2841, 36.8155),
            zoom: 9,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        let marker;
        //create map object
        let map = new google.maps.Map(document.getElementById("googleMap"), mapOptions);
        let info_window = new google.maps.InfoWindow();



        {% for bs in bus %}
        marker = new google.maps.Marker({
            position: new google.maps.LatLng({{ bs.geolocation }}),
            map: map
        });
        google.maps.event.addListener(marker, 'click', function () {
            //display business
            info_window.setContent("{{bs}}");
            info_window.open(map, marker);
            //zoom on marker clicked
            map.setZoom(9);
            map.setCenter(marker.getPosition());
        });
        {% endfor %}

        google.maps.event.addListener(map, 'click', function (event) {
            placeMarker(map, event.latLng);
        });

        function placeMarker(map, location) {
            var marker = new google.maps.Marker({
                position: location,
                map: map
                //icon: '{% static 'markers/laptop.png' %}'
            });
            //var infowindow = new google.maps.InfoWindow({
            //content: 'Latitude: ' + location.lat() +
            // '<br>Longitude: ' + location.lng()
            //});
            infowindow.open(map, marker);
        }
}
</script>
<script
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA0WoecFWukfc9lUgCVcA20W11Eoj49jpo&callback=myMap"></script>
{% include 'partials/js.html' %}