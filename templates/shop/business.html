{% load static %}


<div id="googleMap" style="width:100%;height:800px;"></div>
<br>
<!--    map types-->
<!--    mapTypeId: google.maps.MapTypeId.SATELLITE-->
<!--    mapTypeId: google.maps.MapTypeId.HYBRID-->
<!--    mapTypeId: google.maps.MapTypeId.TERRAIN-->
<script>

    var p;
    function getLocation(){
         if(navigator.geolocation)
            navigator.geolocation.getCurrentPosition(callBack)
        else
             alert("Sorry! your browser is not supporting")
    }
    function callBack(position){
        p = position
        alert("" + p.coords.latitude + " " + p.coords.longitude)
    }

    function myMap() {
        getLocation()
        mapOptions = {
            //center: new google.maps.LatLng(p.coords.latitude, p.coords.longitude),
            center: new google.maps.LatLng(-1.2841,36.8155),
            zoom:9,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
        let marker;
        let map = new google.maps.Map(document.getElementById("googleMap"),mapOptions);
        let info_window = new google.maps.InfoWindow();
        {% for bs in bus %}
            marker = new google.maps.Marker({
                position:new google.maps.LatLng({{bs.geolocation}}),
                map: map
            });

            google.maps.event.addListener(marker, 'click', (function(marker) {
                return function() {
                    info_window.setContent("{{bs}}");
                    info_window.open(map,marker);
                }
            })(marker));
        {% endfor %}

    }


</script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA0WoecFWukfc9lUgCVcA20W11Eoj49jpo&callback=myMap"></script>
